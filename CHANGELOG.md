# 📝 CHANGELOG

すべての重要な変更はこのファイルに記録されます。

## [2.2.0] - 2025-07-26

### 🆕 追加
- **強制リフレッシュオプション**: キャッシュをバイパスして最新データを取得する機能
- **商品画像表示**: 商品詳細に画像表示機能を追加
- **女優プロフィールリンク**: 検索結果にクリック可能な女優プロフィールリンクを追加
- **アイテム数設定**: 表示するアイテム数を1-10個で設定可能
- **検索URL表示**: ヘッダーメッセージに検索URLを表示

### 🔧 改善
- **FANZA検索コマンド**: `fanza_sale` から `fanza_search` に名前変更し、セールフィルターをオプション化
- **パフォーマンス最適化**: Playwrightの並列処理で高速化
- **レート制限調整**: 5分から30秒に短縮
- **フッターメッセージ**: ヘルプコマンドのみ表示に簡素化
- **サムネイル表示**: ヘッダーのサムネイル画像を削除
- **キャッシュシステム**: 全検索オプションに対応

### 🐛 修正
- **Gemini Code Assistレビュー**: 複数のレビューフィードバックを修正
- **商品評価抽出**: 正しいセレクターで評価抽出を修正
- **Discord相互作用タイムアウト**: レート制限でのタイムアウト問題を解決
- **Playwrightスクレイパー**: 'title' KeyErrorを修正
- **force_refreshパラメータ**: FanzaScrapperラッパーでのパラメータ処理を修正

### 📚 ドキュメント更新
- **fanza_searchコマンド**: 新コマンドの詳細ドキュメントを更新
- **全機能対応**: 最新の機能追加に対応したドキュメント更新

## [2.1.0] - 2024-12-26

### 🆕 追加
- **MissAV検索機能**: `/missav_search` コマンドを追加
  - 日本語タイトルで動画を直接検索
  - 女優名、品番、キーワード検索に対応
  - 動画情報（タイトル、URL、サムネイル、再生時間）を表示
  - 関連性スコアによる結果ランキング
  - 30分間のインテリジェントキャッシュ
- **新しいドキュメント**: `MISSAV_GUIDE.md` - MissAV機能の詳細ガイド
- **テスト機能**: MissAV検索のテストスクリプト群
- **デバッグ機能**: サイト構造解析とトラブルシューティング

### 🔧 技術的改善
- **Playwright統合**: MissAVスクレイピング用の新しいモジュール
- **エラーハンドリング**: 検索失敗時の適切なフィードバック
- **セキュリティ**: NSFWチャンネル制限とレート制限の適用
- **パフォーマンス**: キャッシュシステムによる高速化

### 📚 ドキュメント更新
- README.mdにMissAV機能の説明を追加
- 使用例とトラブルシューティングガイドを拡充
- 開発者向け技術仕様を詳述

## [2.0.0] - 2024-12-XX

### 🆕 追加
- **スラッシュコマンド対応**: モダンなDiscordコマンド体験
- **動的ステータス表示**: BOTのステータスが定期的に変更
- **インタラクティブ情報コマンド**: `/bot_info` でBOT詳細情報を表示
- **ページネーション機能**: リスト表示での複数ページ対応

### 🔧 改善
- **Playwright統合**: Seleniumから軽量なPlaywrightに移行
- **エラーハンドリング**: より詳細なエラー報告とログ
- **パフォーマンス最適化**: メモリ使用量の削減

### 📋 セールタイプ対応
- 🎯 全てのセール
- ⏰ 期間限定セール  
- 💸 割引セール (20-70% OFF)
- 📅 日替わりセール
- 💴 激安セール (10円/100円)

## [1.0.0] - 2024-11-XX

### 🆕 初期リリース
- **基本機能**: FANZAセール情報の取得と表示
- **高評価フィルタ**: 評価4.0以上の作品のみを表示
- **Discord Embed**: 美しい表示形式
- **キャッシュシステム**: 1時間のキャッシュでAPI負荷軽減
- **レート制限**: 5分に1回の制限でサーバー保護
- **NSFW制限**: 適切な年齢制限の実装

### 🔧 技術仕様
- **Python 3.9+**: モダンなPython機能を活用
- **discord.py 2.0+**: 最新のDiscord API対応
- **Selenium WebDriver**: 動的コンテンツのスクレイピング
- **beautifulsoup4**: HTMLパース処理

---

## 📝 バージョン表記について

このプロジェクトでは[セマンティックバージョニング](https://semver.org/)を使用しています：

- **MAJOR**: 互換性のない API 変更
- **MINOR**: 後方互換性のある機能追加
- **PATCH**: 後方互換性のあるバグ修正

## 🔗 関連リンク

- [README.md](README.md) - プロジェクト概要
- [MISSAV_GUIDE.md](MISSAV_GUIDE.md) - MissAV機能ガイド
- [GitHub Issues](https://github.com/lalalasyun/fanza-discord-bot/issues) - バグ報告・機能要望